# UniversityMarking 考试监考系统用户手册

## 目录

1. [系统介绍](#系统介绍)
2. [安装指南](#安装指南)
3. [系统配置](#系统配置)
4. [使用说明](#使用说明)
5. [常见问题](#常见问题)
6. [注意事项](#注意事项)

## 系统介绍

UniversityMarking 考试监考系统是一款专为高等院校考试环境设计的安全监考软件。该系统通过综合运用多种技术手段，为考试环境提供全面的安全防护。

### 主要功能

- **全屏锁定：** 防止考生退出考试界面
- **系统键位屏蔽：** 禁用常用系统快捷键
- **任务切换防护：** 阻止 Alt+Tab 等切换操作
- **应用程序启动控制：** 防止运行非授权程序
- **管理员解锁：** 提供安全的解锁机制

### 系统组件

1. **主程序（Electron App）**
   - 提供主要的用户界面
   - 加载考试网页并全屏显示
   - 处理用户交互和解锁操作

2. **系统服务（LockSys Python）**
   - 在后台运行的系统级服务
   - 负责键盘和鼠标事件的拦截
   - 提供 HTTP API 接口供主程序调用

3. **配置工具（ChangeConfigUtil）**
   - 用于修改系统配置参数
   - 设置考试网址和解锁密码
   - 生成配置文件

4. **启动脚本（Start Bat）**
   - 系统启动入口
   - 协调各组件的启动顺序
   - 管理权限提升

## 安装指南

### 系统要求

#### 硬件要求
- **处理器：** Intel/AMD x86 或 x64 架构
- **内存：** 至少 2GB RAM
- **磁盘空间：** 至少 100MB 可用空间
- **网络：** 稳定的网络连接

#### 软件要求
- **操作系统：** Windows Vista/7/8/10/11
- **权限：** 管理员权限（安装时）
- **运行时：** Microsoft Visual C++ 可再发行组件（通常已预安装）

### 安装步骤

#### 1. 获取安装程序

从以下渠道获取安装程序：
- 学校 IT 部门提供的官方安装包
- 项目 GitHub Releases 页面
- 内部软件分发系统

#### 2. 运行安装程序

1. **以管理员身份运行**
   - 右键安装程序文件
   - 选择“以管理员身份运行”

2. **语言选择**
   - 系统支持中文和英文界面
   - 选择适合的语言并点击“确定”

3. **阅读许可协议**
   - 仔细阅读软件许可协议
   - 勾选“我接受协议”并点击“下一步”

4. **选择安装类型**
   - **完整安装：** 安装所有组件（推荐）
   - **自定义安装：** 选择性安装组件

5. **选择安装目录**
   - 默认安装到 `C:\Program Files\UniversityMarking`
   - 可根据需要修改安装路径

6. **选择附加任务**
   - ☑️ 创建桌面快捷方式（推荐）
   - ☑️ 为配置工具创建桌面快捷方式
   - ☑️ 添加到“发送到”菜单

7. **确认安装**
   - 检查安装设置信息
   - 点击“安装”开始安装进程

8. **安装完成**
   - 等待安装进程完成
   - 选择是否立即启动程序
   - 点击“完成”结束安装

#### 3. 安装验证

安装完成后，请验证以下项目：

- ☑️ 桌面上出现“UniversityMarking考试监考系统”快捷方式
- ☑️ 开始菜单中出现相关程序组
- ☑️ 系统服务中存在“UniversityMarkingLockService”
- ☑️ 安装目录下文件结构完整

## 系统配置

### 默认配置

系统安装后将使用以下默认配置：

```json
{
  "mainUrl": "http://localhost:8080",
  "LockUrl": "http://localhost:9529/SysLock",
  "UnLockUrl": "http://localhost:9529/LockOut",
  "UnLockPassWord": "admin123"
}
```

### 使用配置工具

#### 1. 打开配置工具

可通过以下方式打开配置工具：
- 双击桌面上的“监考系统配置工具”快捷方式
- 从开始菜单中选择“配置工具”
- 运行 `C:\Program Files\UniversityMarking\config\ChangeConfigUtil.exe`

#### 2. 配置考试网址

1. 在“考试网址”输入框中输入完整的考试系统 URL
   - 示例：`https://exam.university.edu/exam`
   - 示例：`http://192.168.1.100:8080/test`

2. 确保 URL 格式正确，包含协议头（http:// 或 https://）

#### 3. 设置解锁密码

1. 在“解锁密码”输入框中输入安全密码
2. 密码建议使用：
   - 至少 8 位字符
   - 包含大小写字母、数字和特殊字符
   - 避免使用常见密码或字典词汇

#### 4. 保存配置

1. 点击“保存配置”按钮
2. 系统将显示配置保存成功的提示
3. 配置文件将保存到 `app/config/setConfig.json`

### 手动配置文件

如果需要手动编辑配置文件，可以打开：
`C:\Program Files\UniversityMarking\app\config\setConfig.json`

使用任意文本编辑器（如记事本、Notepad++）进行编辑。

**注意：** 编辑后请确保 JSON 格式正确，否则系统可能无法正常工作。

## 使用说明

### 系统启动

#### 方法 1：使用桌面快捷方式

1. 双击桌面上的“UniversityMarking考试监考系统”快捷方式
2. 系统将自动以管理员权限启动
3. 等待系统加载完成

#### 方法 2：从开始菜单启动

1. 点击开始菜单
2. 找到“UniversityMarking考试监考系统”程序组
3. 点击“UniversityMarking考试监考系统”

### 系统界面

#### 主界面特点

- **全屏显示：** 系统将以全屏模式显示考试内容
- **顶层窗口：** 窗口始终保持在最上层
- **禁用右键：** 右键菜单被禁用
- **隐藏任务栏：** Windows 任务栏自动隐藏

#### 操作控制

在监考模式下，以下操作将被禁用：

- **Alt + Tab**：任务切换
- **Ctrl + Shift + Esc**：任务管理器
- **Ctrl + Alt + Del**：系统中断菜单
- **Windows 键**：开始菜单
- **Alt + F4**：关闭程序
- **F11**：全屏切换

### 管理员解锁

#### 解锁步骤

1. **激活解锁对话框**
   - 按下 `Ctrl + F10` 组合键
   - 系统将显示解锁对话框

2. **输入解锁密码**
   - 在密码输入框中输入正确的管理员密码
   - 密码为配置文件中设置的 `UnLockPassWord` 值

3. **确认解锁**
   - 点击“解锁”按钮或按下 Enter 键
   - 密码正确后系统将退出监考模式

#### 解锁后操作

解锁成功后：
- 系统锁定功能被禁用
- 窗口可以最小化或关闭
- 所有键盘快捷键恢复正常
- 可以访问其他应用程序

### 系统关闭

#### 正常关闭

1. 先使用 `Ctrl + F10` 解锁系统
2. 在解锁后点击窗口右上角的关闭按钮
3. 或使用 `Alt + F4` 关闭程序

#### 强制关闭（紧急情况）

如果系统无响应或出现异常：

1. **使用任务管理器**
   - 按下 `Ctrl + Shift + Esc`（如果未被屏蔽）
   - 或按下 `Ctrl + Alt + Del` 后选择任务管理器
   - 找到并结束 UniversityMarking 相关进程

2. **重启计算机**
   - 如果无法访问任务管理器，可以直接重启计算机

## 常见问题

### 安装相关问题

#### Q1: 安装时提示“需要管理员权限”

**A:** 请确保以管理员身份运行安装程序。

**解决步骤：**
1. 右键安装程序文件
2. 选择“以管理员身份运行”
3. 在 UAC 提示中点击“是”

#### Q2: 安装进程中断

**A:** 可能是杀毒软件或防火墙干扰。

**解决步骤：**
1. 暂时关闭杀毒软件的实时防护
2. 在防火墙中添加安装程序为信任程序
3. 重新运行安装程序

#### Q3: 安装后找不到程序

**A:** 检查安装目录和开始菜单。

**检查步骤：**
1. 检查 `C:\Program Files\UniversityMarking` 目录
2. 检查桌面上是否有快捷方式
3. 在开始菜单中搜索“UniversityMarking”

### 运行相关问题

#### Q4: 程序启动后白屏或无响应

**A:** 可能是网络连接问题或配置错误。

**排查步骤：**
1. 检查网络连接是否正常
2. 验证配置文件中的 URL 是否可以在浏览器中打开
3. 检查防火墙是否封锁了连接
4. 使用配置工具重新设置 URL

#### Q5: 解锁密码不正确

**A:** 检查配置文件中的密码设置。

**解决步骤：**
1. 打开配置文件 `setConfig.json`
2. 查看 `UnLockPassWord` 字段的值
3. 使用该密码进行解锁
4. 如果遗忘密码，可使用配置工具重新设置

#### Q6: 系统锁定功能失效

**A:** 系统服务可能未正常运行。

**排查步骤：**
1. 打开服务管理器（services.msc）
2. 找到“UniversityMarkingLockService”服务
3. 检查服务状态，如果未运行则右键选择“启动”
4. 如果启动失败，检查事件日志查看错误信息

### 性能相关问题

#### Q7: 系统运行缓慢

**A:** 可能是系统资源不足或有其他程序占用资源。

**优化建议：**
1. 关闭不必要的后台程序
2. 检查系统内存使用情况
3. 使用本地网络连接而非广域网
4. 定期清理系统临时文件

#### Q8: 页面加载失败

**A:** 检查网络连接和服务器状态。

**排查步骤：**
1. 在正常浏览器中测试访问考试 URL
2. 检查网络连接是否稳定
3. 联系网络管理员检查服务器状态
4. 尝试更换备用的考试 URL

## 注意事项

### 安全注意事项

1. **密码管理**
   - 定期更改解锁密码
   - 不要将密码告知考生
   - 使用强密码组合

2. **系统权限**
   - 仅在考试期间使用管理员权限
   - 考试结束后及时解锁系统
   - 定期检查系统安全状态

3. **数据安全**
   - 定期备份配置文件
   - 监控系统日志文件
   - 避免在公共网络上使用

### 使用限制

1. **适用范围**
   - 仅适用于正式考试环境
   - 不得用于非教育目的
   - 遵守相关法律法规

2. **技术限制**
   - 需要稳定的网络连接
   - 不支持多显示器环境
   - 可能与某些安全软件冲突

3. **责任限制**
   - 用户应自行评估使用风险
   - 开发者不对使用后果负责
   - 建议在测试环境中充分验证

### 最佳实践

1. **考前准备**
   - 提前测试系统功能
   - 培训监考人员使用方法
   - 准备备用设备和网络

2. **考试期间**
   - 实时监控系统状态
   - 保持网络连接稳定
   - 准备应急预案

3. **考后维护**
   - 及时解锁系统
   - 清理临时文件
   - 备份重要数据

---

## 技术支持

如遇到未在本手册中涉及的问题，请：

1. 检查系统日志文件获取详细错误信息
2. 联系学校 IT 支持部门
3. 在项目 GitHub 仓库中提交问题报告

**版本信息：** v1.0.0  
**最后更新：** 2025-06-20  
**文档维护：** UniversityMarking 开发团队